This script is designed to calculate the number of steps required for numbers to reduce to 1 following the Collatz Conjecture. The program processes 10,000,000 natural numbers using parallel computation techniques, efficiently distributing the workload across multiple processes. Below is an explanation of how the code works:
The main functionality revolves around calculating the steps for each number in the range from 1 to 10,000,000. The function collatz_steps implements the Collatz Conjecture logic, determining the number of steps required for a given number to reach 1. To enhance performance, an LRU cache is applied to this function, allowing previously computed results to be reused. Additionally, the function prefill_cache precomputes the steps for powers of two and caches these results, as they are commonly encountered during the calculations.
The script uses Python's multiprocessing library to achieve parallelism. The worker function performs the Collatz calculation for a subset of numbers. Each process executes this function for a specific range of numbers, ensuring that the workload is evenly distributed. The results of these calculations, including the total steps and the count of numbers processed, are sent back to the main process through a multiprocessing queue.
The number of processes is defined manually using the NUM_PROCESSES variable. This gives the user control over the degree of parallelism based on their system's capabilities. Processes are created and started in a loop, and the main process waits for all child processes to finish their execution. Once all processes are complete, the results are retrieved from the queue and aggregated to calculate the average number of steps for the entire range of numbers.
The script also measures and prints the total execution time, allowing users to observe the performance improvements due to parallel processing. The program is designed to ensure that there are no idle processes, making efficient use of computational resources.
